from Standard.Base import all
import Standard.Base.Errors.Common.Type_Error

import Standard.Table.Internal.Widget_Helpers

import project.Data.Table.Table
import project.Errors.Unsupported_Database_Operation

## GROUP Standard.Base.Conversions
   Expand a column of objects to a new set of columns.

    Arguments:
    - column: The column to expand.
    - fields: The set fields to expand. If `Nothing` then all fields are added.
    - prefix: Prefix to add to the column names. If `Nothing` then the column
      name is used.
@column Widget_Helpers.make_column_name_selector
Table.expand_column : Text | Integer -> Vector | Nothing -> Text | Table -> Table ! Type_Error
Table.expand_column self column fields=Nothing prefix=Nothing =
        _ = [column, fields, prefix]
        Error.throw (Unsupported_Database_Operation.Error "Table.expand_column is currently not implemented for the Database backend. You may download the table to memory using `.read` to use this feature.")
