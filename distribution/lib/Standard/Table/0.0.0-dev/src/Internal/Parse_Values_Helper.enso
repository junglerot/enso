from Standard.Base import all
import Standard.Base.Error.Illegal_State.Illegal_State

from project.Errors import Invalid_Format, Leading_Zeros

polyglot java import org.enso.table.parsing.problems.InvalidFormat
polyglot java import org.enso.table.parsing.problems.LeadingZeros

translate_parsing_problem expected_datatype problem =
    invalid_format = [InvalidFormat, (java_problem-> Invalid_Format.Error java_problem.column expected_datatype (Vector.from_polyglot_array java_problem.cells))]
    leading_zeros = [LeadingZeros, (java_problem-> Leading_Zeros.Error java_problem.column expected_datatype (Vector.from_polyglot_array java_problem.cells))]

    translations = [invalid_format, leading_zeros]
    found = translations.find t-> Java.is_instance problem t.first
    translation = found.catch Any _->
        Error.throw (Illegal_State.Error "Reported an unknown problem type: "+problem.to_text)
    translation.second problem
